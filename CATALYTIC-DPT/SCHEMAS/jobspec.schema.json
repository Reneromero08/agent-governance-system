{
  "$schema": "http://json-schema.org/draft-07/schema#",
  "$id": "jobspec.schema.json",
  "title": "CAT-DPT JobSpec",
  "type": "object",
  "additionalProperties": false,
  "$comment": "CAT-DPT Phase 0 contract schema. Freeze via git tag after first release.",
  "required": [
    "job_id",
    "phase",
    "task_type",
    "intent",
    "inputs",
    "outputs",
    "catalytic_domains",
    "determinism"
  ],
  "properties": {
    "job_id": {
      "type": "string",
      "description": "Unique job identifier (kebab-case).",
      "pattern": "^[a-z0-9-]+$"
    },
    "phase": {
      "type": "integer",
      "description": "Roadmap phase number.",
      "minimum": 0
    },
    "task_type": {
      "type": "string",
      "description": "Canonical task category.",
      "enum": [
        "schema_definition",
        "primitive_implementation",
        "validation",
        "test_execution",
        "adapter_execution",
        "pipeline_execution"
      ]
    },
    "intent": {
      "type": "string",
      "description": "One-sentence human description of the job.",
      "minLength": 1
    },
    "inputs": {
      "type": "object",
      "description": "Task-specific inputs. May include hash references.",
      "additionalProperties": true
    },
    "outputs": {
      "type": "object",
      "description": "Expected durable outputs and validation criteria.",
      "additionalProperties": false,
      "required": [
        "durable_paths",
        "validation_criteria"
      ],
      "properties": {
        "durable_paths": {
          "type": "array",
          "description": "Paths that may remain after run completion.",
          "items": {
            "type": "string",
            "minLength": 1
          }
        },
        "validation_criteria": {
          "type": "object",
          "description": "Machine-checkable acceptance criteria (free-form, but should be deterministic).",
          "additionalProperties": true
        }
      }
    },
    "catalytic_domains": {
      "type": "array",
      "description": "Scratch domains that must be restored byte-identical post-run.",
      "items": {
        "type": "string",
        "minLength": 1
      }
    },
    "determinism": {
      "type": "string",
      "description": "Determinism requirement for the job.",
      "enum": [
        "deterministic",
        "bounded_nondeterministic",
        "nondeterministic"
      ]
    },
    "swarm_parallel": {
      "type": "boolean",
      "description": "Hint: safe to run as a parallel worker job.",
      "default": false
    },
    "metadata": {
      "type": "object",
      "description": "Optional governance metadata: scheduling, priority, provenance, etc.",
      "additionalProperties": true,
      "default": {}
    }
  }
}
